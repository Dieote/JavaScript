<div class="contenedor">
  <header class="cabecera">
    <h1>Tienda Online</h1>
    <button class="btn-carrito" [class.activo]="totalUnidades > 0" (click)="toggleCarrito()">
       Carrito
      <span class="badge" *ngIf="totalUnidades > 0">{{ totalUnidades }}</span>
    </button>
  </header>

  <app-filtros
    [categorias]="categorias"
    [marcas]="marcas"
    (filtrosAplicados)="aplicarFiltros($event)"
    (filtrosLimpiados)="limpiarFiltros()">
  </app-filtros>

  <main class="catalogo">
    <div *ngIf="cargando" class="cargando">
      <div class="spinner"></div>
      <p>Cargando productos...</p>
    </div>

    <div *ngIf="error" class="error">
      {{ error }}
    </div>

    <div *ngIf="!cargando && !error && productosFiltrados.length === 0" class="sin-resultados">
      <p>No se encontraron productos</p>
    </div>

    <div class="productos" *ngIf="!cargando && !error && productosFiltrados.length > 0">
      <div *ngFor="let producto of productosFiltrados" class="producto">
        <div class="imagen">
          <img [src]="producto.thumbnail" [alt]="producto.title">
          <span class="descuento" *ngIf="producto.discountPercentage > 0">
            -{{ producto.discountPercentage }}%
          </span>
        </div>

        <div class="info">
          <h3>{{ producto.title }}</h3>
          
          <div class="etiquetas">
            <span class="etiqueta">{{ producto.category }}</span>
            <span class="etiqueta">{{ producto.brand }}</span>
          </div>

          <div class="rating">⭐ {{ producto.rating }}</div>

          <p class="precio">€{{ producto.price }}</p>

          <button class="btn-agregar" (click)="agregarAlCarrito(producto)">Añadir al carrito</button>
        </div>
      </div>
    </div>
  </main>

  <app-carrito [visible]="carritoVisible" (cerrado)="cerrarCarrito()"></app-carrito>

  <div class="overlay" *ngIf="carritoVisible" (click)="cerrarCarrito()"></div>
</div>
